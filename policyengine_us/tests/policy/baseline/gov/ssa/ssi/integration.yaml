# Integration tests for SSI program
- name: Integration test - SSI benefit calculation for disabled individual with ineligible working spouse (2025)
  period: 2025
  input:
    people:
      person1:
        age: 60
        is_disabled: true
        is_tax_unit_spouse: true
        ssi_earned_income: 0
        ssi_unearned_income: 0
      person2:
        age: 55
        is_disabled: false
        is_tax_unit_head: true
        ssi_earned_income: 31_080
        ssi_unearned_income: 0
    tax_units:
      tax_unit:
        members: [person1, person2]
    marital_units:
      marital_unit:
        members: [person1, person2]
  output:
    # Verify the intermediate variables for clarity
    is_ssi_eligible_individual:
      2025:
        - true  # person1
        - false # person2
    is_ssi_ineligible_spouse:
      2025:
        - false # person1
        - true  # person2 
    ssi_income_deemed_from_ineligible_spouse:
      2025:
        - 15_030 # person1
        - 0      # person2
    ssi_countable_income:
      2025:
        - 15_030 # person1
        - 0      # person2
    ssi_claim_is_joint:
      2025:
        - true  # person1 (has ineligible spouse)
        - false # person2
    ssi_amount_if_eligible:
      2025:
        - 17_400 # person1 (couple rate)
        - 11_604 # person2 (not used since person2 is not eligible)
    uncapped_ssi:
      2025:
        - 2_370  # person1 (17,400 - 15,030)
        - 0      # person2
    # Final SSI benefit
    ssi:
      2025:
        - 2_370  # person1 
        - 0      # person2

- name: Integration test - SSI benefit for disabled individual with income just below FBR differential threshold (2025)
  period: 2025
  input:
    people:
      person1:
        age: 65
        is_disabled: true
        is_tax_unit_spouse: true
        ssi_earned_income: 0
        ssi_unearned_income: 0
      person2:
        age: 60
        is_disabled: false
        is_tax_unit_head: true
        # Income after exclusions should be just below the FBR differential
        ssi_earned_income: 4_360
        ssi_unearned_income: 0
    tax_units:
      tax_unit:
        members: [person1, person2]
    marital_units:
      marital_unit:
        members: [person1, person2]
  output:
    ssi_income_deemed_from_ineligible_spouse:
      2025:
        - 0 # No deeming occurs when under the FBR differential threshold
        - 0
    ssi_countable_income:
      2025:
        - 0 # person1 (no deemed income)
        - 0 # person2
    ssi_claim_is_joint:
      2025:
        - true  # person1 (has ineligible spouse)
        - false # person2
    ssi_amount_if_eligible:
      2025:
        - 17_400 # person1 (couple rate) 
        - 11_604 # person2 (not used since person2 is not eligible)
    # Final SSI benefit
    ssi:
      2025:
        - 17_400 # person1 (full benefit with no deductions)
        - 0      # person2

- name: Integration test - SSI benefit for disabled individual with both earned and unearned income (2025)
  period: 2025
  input:
    people:
      person1:
        age: 65
        is_disabled: true
        is_tax_unit_spouse: true
        ssi_earned_income: 3_600
        ssi_unearned_income: 2_400
      person2:
        age: 60
        is_disabled: false
        is_tax_unit_head: true
        ssi_earned_income: 24_000
        ssi_unearned_income: 0
    tax_units:
      tax_unit:
        members: [person1, person2]
    marital_units:
      marital_unit:
        members: [person1, person2]
  output:
    ssi_income_deemed_from_ineligible_spouse:
      2025:
        - 11_730 # person1
        - 0      # person2
    ssi_countable_income:
      2025:
        - 15_570 # person1 (includes own countable income + deemed income)
        - 0      # person2
    ssi_claim_is_joint:
      2025:
        - true  # person1 (has ineligible spouse)
        - false # person2
    ssi_amount_if_eligible:
      2025:
        - 17_400 # person1 (couple rate)
        - 11_604 # person2 (not used since person2 is not eligible)
    # Final SSI benefit
    ssi:
      2025:
        - 1_830 # person1 (17,400 - 15,570)
        - 0     # person2
