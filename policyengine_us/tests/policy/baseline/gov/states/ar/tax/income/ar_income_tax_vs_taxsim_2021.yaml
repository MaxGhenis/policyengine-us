# Comparison tests between PolicyEngine US and TaxSim for Arkansas income tax
# Using 2021 tax year since that's the latest year TaxSim supports for Arkansas
# TaxSim implementation is in ../taxsim/taxsim.f subroutine artax

- name: Compare with TaxSim - Single filer $50,000 taxable income (2021)
  period: 2021
  input:
    ar_taxable_income_indiv: 50_000
    ar_files_separately: true
    state_code: AR
  output:
    # TaxSim 2021 calculation for Arkansas:
    # From tab21t in taxsim.f:
    # Tax brackets: 0%, 2%, 3%, 3.4%, 5%, 5.9% 
    # Thresholds: $4,799, $9,499, $14,299, $23,599, $39,699
    # For $50,000: Rate is 5.9%, reduction is $797.25
    # Tax = 0.059 * 50,000 - 797.25 = 2,950 - 797.25 = 2,152.75
    ar_income_tax_before_non_refundable_credits_indiv: 2_152.75

- name: Compare with TaxSim - Single filer $25,000 taxable income (2021)
  period: 2021
  input:
    ar_taxable_income_indiv: 25_000
    ar_files_separately: true
    state_code: AR
  output:
    # TaxSim 2021 calculation:
    # $25,000 falls in 5% bracket (over $23,599)
    # From tab21t: reduction is $439.96
    # Tax = 0.05 * 25,000 - 439.96 = 1,250 - 439.96 = 810.04
    ar_income_tax_before_non_refundable_credits_indiv: 810.04

- name: Compare with TaxSim - Single filer $15,000 taxable income (2021)
  period: 2021
  input:
    ar_taxable_income_indiv: 15_000
    ar_files_separately: true
    state_code: AR
  output:
    # TaxSim 2021 calculation:
    # $15,000 falls in 3.4% bracket ($14,299-$23,599)
    # From tab21t: reduction is $248.17
    # Tax = 0.034 * 15,000 - 248.17 = 510 - 248.17 = 261.83
    ar_income_tax_before_non_refundable_credits_indiv: 261.83

- name: Compare with TaxSim - Single filer $10,000 taxable income (2021)
  period: 2021
  input:
    ar_taxable_income_indiv: 10_000
    ar_files_separately: true
    state_code: AR
  output:
    # TaxSim 2021 calculation:
    # $10,000 falls in 3% bracket ($9,499-$14,299)
    # From tab21t: reduction is $190.97
    # Tax = 0.03 * 10,000 - 190.97 = 300 - 190.97 = 109.03
    ar_income_tax_before_non_refundable_credits_indiv: 109.03

- name: Compare with TaxSim - Single filer $5,000 taxable income (2021)
  period: 2021
  input:
    ar_taxable_income_indiv: 5_000
    ar_files_separately: true
    state_code: AR
  output:
    # TaxSim 2021 calculation:
    # $5,000 falls in 2% bracket ($4,799-$9,499)
    # From tab21t: reduction is $95.98
    # Tax = 0.02 * 5,000 - 95.98 = 100 - 95.98 = 4.02
    ar_income_tax_before_non_refundable_credits_indiv: 4.02

- name: Compare with TaxSim - Single filer $100,000 taxable income (2021)
  period: 2021
  input:
    ar_taxable_income_indiv: 100_000
    ar_files_separately: true
    state_code: AR
  output:
    # TaxSim 2021 calculation:
    # $100,000 is in highest bracket (5.9% over $39,699)
    # From tab21t: for income over $90,100, reduction is $247.50
    # Tax = 0.059 * 100,000 - 247.50 = 5,900 - 247.50 = 5,652.50
    ar_income_tax_before_non_refundable_credits_indiv: 5_652.50

- name: Compare with TaxSim - Single filer at bracket threshold $23,599 (2021)
  period: 2021
  input:
    ar_taxable_income_indiv: 23_599
    ar_files_separately: true
    state_code: AR
  output:
    # TaxSim 2021 calculation:
    # $23,599 is last dollar of 3.4% bracket
    # From tab21t: reduction is $248.17
    # Tax = 0.034 * 23,599 - 248.17 = 802.366 - 248.17 = 554.20
    ar_income_tax_before_non_refundable_credits_indiv: 554.20

- name: Compare with TaxSim - Single filer at bracket threshold $39,699 (2021)
  period: 2021
  input:
    ar_taxable_income_indiv: 39_699
    ar_files_separately: true
    state_code: AR
  output:
    # TaxSim 2021 calculation:
    # $39,699 is last dollar of 5% bracket
    # From tab21t: reduction is $439.96
    # Tax = 0.05 * 39,699 - 439.96 = 1,984.95 - 439.96 = 1,544.99
    ar_income_tax_before_non_refundable_credits_indiv: 1_544.99